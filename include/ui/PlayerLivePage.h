#ifndef __PlayerLivePage__
#define __PlayerLivePage__

/**
@file
Subclass of LivePage, which is generated by wxFormBuilder.
*/

#include "LivePage.h"
#include "RenderTimer.h"
#include<mutex>
#include<vector>
#include<Windows.h>
#include "wx/dcbuffer.h"
#include "wx/filefn.h"
#include "wx/dir.h"
#include"wx/event.h"
#include<map>
#include"Controller.h"

extern "C"
{
#include "SDL2/SDL.h"
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>
#include<libavutil/frame.h>
#include <libswscale/swscale.h>
#include <libswresample/swresample.h>
#include "libavdevice/avdevice.h"
#include "libavcodec/avcodec.h"
#include "libavformat/avformat.h"
#include "libswscale/swscale.h"
#include "libavdevice/avdevice.h"
#include "libavutil/imgutils.h"
}

using std::mutex;
using std::vector;
using std::map;

wxDEFINE_EVENT(wxEVT_CUSTOM_UI_COMMAND, wxCommandEvent);

enum VIDEOSTATUS{
	STOP,		//暂停播放
	PLAYING,	//正在播放
	NOVIDEO		//没有正在播放的视频
};


//// end generated include

/** Implementing LivePage */
class PlayerLivePage : public LivePage
{
	private:
		RenderTimer *timer = NULL;
		vector<AVFrame *> frameVec{};
		mutex mtx;
		Controller controller{};
		map<int, wxString> fileCache{};
		VIDEOSTATUS statue = NOVIDEO;

	protected:
		// Handlers for LivePage events.
		void paintEvent(wxPaintEvent& event);
		void processSlideOnSlider(wxCommandEvent& event);
		void lastVideo(wxCommandEvent& event);
		void playBtnClick(wxCommandEvent& event);
		void nextVideo(wxCommandEvent& event);
		void videoSelect(wxListEvent& event);
		void chooseFolder(wxCommandEvent& event);
		void renderPic(wxDC *dc);
	public:
		/** Constructor */
		PlayerLivePage( wxWindow* parent );

		void Callback(wxCommandEvent &evt);

		void Callback(CallBackType type, int time);
		
	//// end generated class members

};

#endif // __PlayerLivePage__
